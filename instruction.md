请帮我优化这个训练智能体的代码，让其在对地图不断的探索中学习移动策略，减少碰撞障碍物，以最少的步数从起点走到终点，并尽可能多的收集宝箱。

你在优化改进代码时需要格外注意的地方有:
1. 你需要从documents目录下面的简介、环境介绍、代码包介绍、数据协议对整个项目的上下文有更全面深入的理解
2. 算法的优化主要围绕着dqn和target_dqn的模型来改进，因此diy的目录可以直接忽略
3. 尽可能的完善代码中TODO的部分，并且完善的代码要保证上下文的关联合理性
4. 每一处你优化的代码和参数都需要加上注释，以此详细的解释你这么优化的原因
5. 在documents目录下有前人优化经验，你可以参考前人的经验，但是不要完全按照前人的经验来，因为前人的经验不一定适合当前的场景
6. 在优化改进代码时，你需要注意代码的上下文，要用全局的视角来优化，不要破坏代码的完整性、功能性和可读性
